# ══════════════════════════════════════════════════════════════
# ✨ CONFIGURACIÓN TMUX - Organizada y estructurada
# ══════════════════════════════════════════════════════════════

# ── 🎨 TERMINAL Y COLORES ─────────────────────────────────────
set -g default-terminal "tmux-256color"
set -as terminal-overrides ",xterm-256color:Tc"

# ── 🔧 CONFIGURACIÓN GENERAL ──────────────────────────────────
set -g mouse on                    # Habilitar soporte de ratón
set -g allow-passthrough on        # Soporte de imágenes en lazy vim
set -g visual-activity off         # Desactivar notificaciones visuales

# ── ⌨️  PREFIJO Y ATAJOS PRINCIPALES ──────────────────────────
unbind C-b                                # Remover prefijo por defecto
set-option -g prefix C-a                  # Establecer C-a como prefijo
bind-key C-a send-prefix                  # Enviar prefijo literal con C-a C-a
bind C-l send-keys 'C-l' \; clear-history # ctrl + L para limpiar historial

# ── 📱 DIVISIÓN DE PANELES ────────────────────────────────────
unbind '"'                         # Remover atajo por defecto
unbind %                           # Remover atajo por defecto
bind | split-window -h             # Dividir horizontalmente con |
bind - split-window -v             # Dividir verticalmente con -

# ── 🧭 NAVEGACIÓN ENTRE PANELES ───────────────────────────────
# Alt + flechas direccionales (sin conflicto con LazyVim)
bind -n M-Left select-pane -L      # Alt + ← para panel izquierdo
bind -n M-Right select-pane -R     # Alt + → para panel derecho
bind -n M-Up select-pane -U        # Alt + ↑ para panel superior
bind -n M-Down select-pane -D      # Alt + ↓ para panel inferior

# ── 🪟 GESTIÓN DE VENTANAS ────────────────────────────────────
bind c new-window -c "#{pane_current_path}"  # Nueva ventana en directorio actual

# Numeración de ventanas y paneles desde 1 (más intuitivo)
set -g base-index 1               # Ventanas empiezan en 1
set-window-option -g pane-base-index 1    # Paneles empiezan en 1

# Navegación rápida entre ventanas (sin conflicto con LazyVim)
bind -n M-1 select-window -t 1     # Alt + 1,2,3... ventanas específicas
bind -n M-2 select-window -t 2
bind -n M-3 select-window -t 3
bind -n M-4 select-window -t 4
bind -n M-5 select-window -t 5

# Ventana anterior/siguiente (compatible con vim muscle memory)
bind -n M-p previous-window        # Alt + p (previous)
bind -n M-n next-window           # Alt + n (next)

# ── ⚙️  UTILIDADES ─────────────────────────────────────────────
bind r source-file ~/.tmux.conf   # Recargar configuración con prefix + r

# 🎯 RESIZE DE PANELES (muy útil para programadores)
bind -n M-H resize-pane -L 5       # Alt + Shift + H/J/K/L
bind -n M-J resize-pane -D 5       # Resize sin prefijo = súper fluido
bind -n M-K resize-pane -U 5
bind -n M-L resize-pane -R 5

# 💥 GESTIÓN AVANZADA DE PANELES
bind f resize-pane -Z              # Prefix + f = zoom/unzoom panel (GOLD!)
bind x kill-pane                   # Prefix + x = cerrar panel (sin confirmación)
bind X kill-window                 # Prefix + X = cerrar ventana completa
bind Space next-layout             # Prefix + Space = rotar layouts de paneles

# 🔄 SPLIT INTELIGENTES (siempre en directorio actual)
bind | split-window -h -c "#{pane_current_path}"  # Split horizontal en dir actual
bind - split-window -v -c "#{pane_current_path}"  # Split vertical en dir actual

# 📋 MODO COPY MEJORADO (compatible con vim)
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "wl-copy"

# 🎚️ SINCRONIZACIÓN DE PANELES (útil para múltiples servidores)
bind S set-window-option synchronize-panes\; display-message "Sync paneles: #{?synchronize-panes,ON,OFF}"

# ── 🎯 CONFIGURACIÓN DE ESTADO ────────────────────────────────
# set -g status-position top       # Descomenta para barra superior

# ── 🔌 PLUGINS ─────────────────────────────────────────────────
set -g @plugin 'tmux-plugins/tpm'          # Gestor de plugins
set -g @plugin 'nordtheme/tmux'            # Tema Nord

# 💾 Plugins de persistencia (comentados)
# set -g @plugin 'tmux-plugins/tmux-resurrect'  # Guardar sesiones
# set -g @plugin 'tmux-plugins/tmux-continuum'  # Auto-guardar sesiones

# ── 🚀 INICIALIZACIÓN DE TPM (SIEMPRE AL FINAL) ───────────────
run-shell ~/.tmux/plugins/tpm/tpm

set -g status 2
set -Fg 'status-format[1]' '#{status-format[0]}'
set -g status-format[0] '#[bg=#2e3440,fill=#2e3440]#[align=centre] '
